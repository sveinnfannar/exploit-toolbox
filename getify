#!/usr/bin/python2
"""Construct a http get request for skel.ru.is

Example usage:
echo "e8 de ad be ef    # call deadbeef
'90' * 28               # create 28 NOPS
rev('ca fe ba be')      # reverse the bytes for little endian machines
asm('''                 # inline arbitrary assembly (note triple ''')
    push $0x08048c93
    ret
''')
" > exploit.in
./hexify exploit.in > exploit.out

# Moterfukkin send the data
getify sveinnk10 `./makecookie sveinnk10` 4 `hexify --ascii 4.txt` | nc skel.ru.is 1336

Author: Sveinn Fannar
"""

import os
import binascii
import sys

if len(sys.argv) < 4:
    exit("usage: getify <userid> <cookie> <level #> <exploit string>")

userid, cookie, level, exploit = sys.argv[1:5]
new_exploit = ""
for i in range(0, len(exploit), 2):
    new_exploit += "%s+" % exploit[i:i+2]
str = "GET /csapp/submitr.pl/?userid=%s&lab=buflab&result=%s%%3A%s%%3A%s&submit=submit HTTP/1.0" % (userid, level, cookie, new_exploit)
sys.stdout.write(str)
